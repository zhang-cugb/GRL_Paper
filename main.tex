\documentclass[a4paper]{article}

%% Language and font encodings
\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
\usepackage[parfill]{parskip}

%% Sets page size and margins
\usepackage[a4paper,top=1.5cm,bottom=1.5cm,left=2cm,right=2cm,marginparwidth=1.75cm]{geometry}

%% Useful packages
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\newcommand{\matr}[1]{\mathbf{#1}}
\usepackage{subcaption}
\usepackage{subfiles}



\title{Partitioning Thresholds in Hybrid Implicit and Explicit Representations of Naturally Fractured Reservoirs}
\author{Daniel Wong Lorng Yon \and Florian Doster \and Sebastian Geiger \and Arjan Kamp}

\begin{document}
\maketitle

\textbf{Key Points}
\begin{itemize}
	\item Small fractures up to a threshold size can be lumped with the rock matrix and upscaled into an equivalent porous medium without affecting the resulting model's accuracy.
	\item The threshold size can be determined from the relationship between upscaled permeabilities and partitioning sizes, the latter which determines whether or not a fracture is considered small.
	\item This relationship can generally be established via numerical flow based upscaling, but for penny shaped fractures, the more efficient Effective Medium Theory can also be used.
\end{itemize}

\begin{abstract}
Flow modeling in naturally fractured reservoirs is a challenging task due to the multiscale nature of fracture networks. The process can be simplified by upscaling small fractures with the rock matrix into an equivalent porous medium, and representing large fractures explicitly. The resulting model is a Single Porosity (SP) hybrid model. Different models can be created based on the choice of the partitioning size, which determines how the fractures are divided. For small partitioning sizes, more fractures will be represented, which leads to higher computational costs. On the other hand, excessively large partitioning sizes may result in an undesirable loss of details. In our studies, for each dataset, we observe that up to a threshold partitioning size, hybrid models closely match original models in terms of simulation output. However, beyond the threshold, hybrid model results show marked deviations away from reference solutions. The threshold partitioning size can be identified from the relationship between upscaled permeabilities and partitioning sizes, and corresponds to the point where the effective permeability of small fractures begin to increase rapidly. The relationship can be obtained numerically via flow based upscaling, or analytically using the Effective Medium Theory. The former method is robust but slow, while the latter is restricted to elliptical fractures but is significantly faster.
\end{abstract}

\section{Introduction}
Naturally fractured reservoirs (NFR) are commonplace in nature and of great interest in areas including but not limited to hydrocarbon extraction, geothermal resource exploitation, and containment of nuclear waste disposal \cite{Berkowitz2002}. More recently, there has also been 
interest in NFRs as a potential site for carbon sequestration \cite{March2018}. In all these applications, the central process at play is fluid flow in fractured porous media, and accurately modelling this process is crucial for engineering success.

However, the highly heterogeneous nature of NFRs makes flow modelling difficult. Instead of representing all fractures in a simulation model, a popular approach, known as the continuum method, is to represent the fracture network as equivalent porous media \cite{Ezulike2013, Warren1963, Yan2016}. The conversion from discrete fractures to a continuum representation involves an averaging process known as upscaling, which can be performed numerically or analytically \cite{Durlofsky1991,Oda1985,Renard1997,Saevik2013}. In this paper, we make extensive use of an analytical upscaling tool known as the Effective Medium Theory (EMT) which was recently adapted for fractured porous media, and was shown to outperform traditional techniques like Oda's method \cite{Oda1985, Saevik2013, Saevik2014}. 

For multiscale NFRs, unfortunately, upscaled equivalent permeability fields have been shown to be dependent on the choice of homogenization scale; this will eventually lead to varying flow modelling outcomes \cite{Elfeel2013}. In particular, NFRs tend to contain fractures with various sizes that oftentimes follow a power law distribution \cite{Bonnet2001}. This implies that no Representative Elementary Volume (REV) can be defined, which invalidates the upscaling step necessary in continuum modelling \cite{Berkowitz2002}.

Nevertheless, as fully resolving all fractures in a simulation model is prohibitively expensive, model simplification is still highly desirable. One way forward is to use a divide-and-conquer approach known as hybrid modelling \cite{Berkowitz2002}. In this method, the fracture network has to be partitioned into two sets: one set with fracture sizes less than the partitioning size, and another with larger fractures. Using either numerical or analytical upscaling, small fractures and the rock matrix are replaced with equivalent porous media. Meanwhile, the large fractures are explicitly represented. Constructing a hybrid model using a small partitioning size preserves as much details as possible, at the expense of computational efficiency. On the other hand, large partitioning sizes yield significant model reductions, but at the cost of model accuracy.

In this paper, we compare performances of hybrid models created using various partitioning sizes against full model solutions. The hybrid models are constructed by upscaling the matrix and small fractures into a single continuum, and as such are called Single Porosity (SP) hybrid models. The results ascertain that hybrid models can indeed be used to simplify complex fractured reservoir simulations, but is restricted to partitioning sizes below observed thresholds. From the relationship between effective permeability and partitioning size, we also observe that the thresholds correspond with partitioning sizes where the effective permeability of small fractures begin to increase rapidly. This relationship can be produced using numerical flow based upscaling, but for penny shaped fractures, the more efficient EMT can also be used.



\section{Methods}
\subsection{Data}
Discrete Fracture Networks (DFN) are generated synthetically as well as using fracture trace maps sourced from outcrops in Brazil. See Figures \ref{fig:DD} for samples.

For DFN generation, the parameters used are $P_{32}$ the fracture density, $n_s$ the power law exponent of fracture sizes, $s_{min}$ and $s_{max}$ respectively the minimum and maximum fracture sizes, $L_{dom}$ the size of the model domain, and $n_a$ the power law exponent of aperture-size relationship. See Table \ref{table:DFNparams} for four cases.

\begin{table}[h]
	\centering
	\caption{Parameters for DFN generation.}
	
	\begin{tabular}{c r r r r l}
		Case & $P_{32}$ & $n_s$ & $s_{min}$ & $s_{max}$ & Remark \\
		\hline
		A & 0.150 & 1.50 & 5.0 & 20 & Base case\\
		B & 0.300 & 1.50 & 5.0 & 20 & 2x $P_{32}$\\
		C & 0.150 & 3.00 & 5.0 & 20 & 2x $n_s$\\
		D & 0.150 & 1.50 & 5.0 & 40 & 2x $s_{max}$\\
		
	\end{tabular}
	\label{table:DFNparams}
\end{table}



\subsection{Simulation Setup}
Discuss how hybrid models are created from DFN. This involves FSU which we perform numerically. For the DFNs generated using Table \ref{table:DFNparams}, the conditions allow for the use of EMT. Hence, FSU was also performed with EMT for comparison.

Given fractures with size between $[s_{min},s_{max}]$, if we pick a partitioning size, $s_p$ and upscale fractures between $[s_{min},s_p]$, we obtain an effective permeability $K_{eff}(s_p)$. $K_{eff}/K_m$ vs $s_p$ typically exhibits a threshold $s_p^*$ beyond which $K_{eff}$ grows rapidly, implying well-connectedness. See figure.

FSU can be performed via numerical flow based upscaling, which is more versatile but slow. In our case, we used EDFM. Alternatively, EMT can also be used to perform analytical FSU. This is faster but limited to specific cases. Refer to figure showing comparison of results.

Describe test conditions the DFNs were subject to.

\section{Results}
\subsection{Effective Permeability and Partitioning Size}
\subfile{FSU/FSU_main.tex}

\subsection{Single Phase Flow in Hybrid Models}
\subfile{DD_main/DD_figs.tex}


\subsection{Accuracy of Effective Medium Theory}
See Figure \ref{fig:FSU}.

Describe how FSU using EMT matches very well for 3D cases.

Discuss time savings using EMT.

\section{Discussion}
\subsection{Effect of Partitioning Size on Response Accuracy}
Discuss how hybrid models corresponding to low partitioning size match full model results very well, but in all cases, above a certain threshold, $s_p^*$, output starts to deviate.

\subsection{\textit{A priori} Identification of Partitioning Threshold}
Discuss identification of $s_p^*$ by plotting $K_{eff}/K_m$ against $s_p$ and where $s_p^*$ is located on the FSU curves.

\section{Conclusion}
We performed numerical studies on full and hybrid models of fracture systems (created with varying partitioning sizes) by subjecting them to similar production conditions. Analysis of the results obtained showed that:

\begin{itemize}
    \item There exists a threshold partitioning size, $s_p^*$ beyond which SP hybrid modelling is observed to produce significant errors compared to the full model reference solution. This is evident in both generated 3D DFNs and realistic fracture networks traced from outcrops.
    
    \item FSU curves exhibit a percolation behaviour and takes on an S-shape. For our studies, $s_p^*$ is consistently located right before fracture subset effective permeability starts to increase rapidly. This is consistent with the requirement that no separation of scale should occur in order to use a SP model.
    
    \item Numerical FSU is a slow process which takes hours to complete. For elliptical fractures, FSU can be performed analytically using EMT, which reduces processing time to seconds. FSU results by EMT were shown to match numerical FSU results very well. $s_p^*$ can also be identified from the EMT FSU curves. 
    
\end{itemize}

\bibliographystyle{acm}
\bibliography{/Users/danie/Documents/phd-daniel/Bibtex/library}

\end{document}